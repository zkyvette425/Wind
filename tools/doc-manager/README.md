# 文档管理工具集

## 🎯 目标
解决Claude Code Read工具25KB字符限制问题，建立智能文档分片管理系统。

## 📁 工具清单

### 1. check-doc-size.bat - 文档大小检查工具
**功能**: 检查文档当前大小，预估添加内容后是否超限
**用法**: 
```bash
# 检查单个文档
check-doc-size.bat "plans\版本变更日志.md"

# 预估添加内容后的大小
check-doc-size.bat "plans\版本变更日志.md" "temp\new-content.txt"
```

**返回码**:
- 0: OK - 容量充足
- 1: WARNING - 接近容量限制  
- 2: SPLIT_REQUIRED - 需要分片
- 3: CRITICAL - 已超过限制

### 2. split-document.bat - 自动文档分片工具
**功能**: 自动将超限文档按规则分片
**规则**:
- 时间序列文档: 按月分片 (`文档名-YYYY-MM.md`)
- 主题型文档: 按技术领域分片 (`文档名-主题.md`)
- 配置型文档: 版本化管理 (`文档名-v2.md`)

### 3. create-index.bat - 索引文件生成工具
**功能**: 为分片文档创建导航索引
**特性**:
- 自动扫描同名分片文件
- 生成文件大小和最后修改时间
- 创建快速查找链接

### 4. auto-split.bat - 智能分片触发器
**功能**: 在添加内容前自动检查并执行分片
**流程**:
1. 检查文档大小
2. 预估新增内容
3. 如需分片，自动执行
4. 更新索引文件
5. 安全写入新内容

## 🚀 使用流程

### 标准文档写入流程
```bash
# 1. 检查文档状态
check-doc-size.bat "plans\版本变更日志.md"

# 2. 如果需要分片，执行分片
split-document.bat "plans\版本变更日志.md" --type=timeline

# 3. 更新索引
create-index.bat "plans\版本变更日志"

# 4. 写入新内容（通过Claude Code）
```

### 自动化流程
```bash
# 一键智能处理
auto-split.bat "plans\版本变更日志.md" "新增内容..." --write
```

## 📊 安全阈值设置

- **Read工具限制**: 25,000字符
- **安全阈值**: 22,000字符（留3KB缓冲）
- **警告阈值**: 20,000字符
- **最佳范围**: 5,000-18,000字符

## 🔄 分片策略

### 时间序列文档
适用于: 版本变更日志、质量事故档案
```
原文件: 版本变更日志.md
分片结果:
├── 版本变更日志-2025-08.md (当前活跃)
├── 版本变更日志-2025-07.md (已归档)
├── 版本变更日志-2025-06.md (已归档)
└── 版本变更日志-索引.md (导航文件)
```

### 主题型文档
适用于: 技术研究记录、测试验证管理
```
原文件: 技术研究记录.md
分片结果:
├── 技术研究记录-MongoDB.md
├── 技术研究记录-Orleans.md
├── 技术研究记录-Docker.md
└── 技术研究记录-索引.md
```

### 配置型文档
适用于: 纲领、决策记录
```
原文件: 纲领.md
版本结果:
├── 纲领.md (当前版本)
├── 纲领-v1.md (历史版本)
└── 纲领-变更历史.md (版本说明)
```

## ⚠️ 注意事项

1. **备份机制**: 每次分片前自动备份原文件
2. **引用完整性**: 保持文档间链接的有效性
3. **索引更新**: 分片后必须更新索引文件
4. **命名规范**: 严格遵循分片命名规则
5. **容量监控**: 定期检查所有文档大小

## 🛠️ 维护任务

- 每周检查大型文档状态
- 每月清理过期分片文件
- 季度优化分片策略
- 年度归档历史数据